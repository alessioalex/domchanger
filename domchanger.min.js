("object"==typeof module&&"object"==typeof module.exports&&function(e){module.exports=e()}||"function"==typeof define&&function(e){define("domchanger",e)}||function(e){window.domChanger=e()})(function(){"use strict"
function e(n,o,i){function l(){k.parentNode.appendChild(k),Object.keys(b).forEach(function(e){var t=b[e]
t.el?o.appendChild(t.el):t.append&&t.append()})}function c(){k.parentNode.removeChild(k),k=null,f(b),delete C.update,delete C.destroy,delete C.handleEvent,x()}function f(e){Object.keys(e).forEach(function(t){var n=e[t]
n.el?n.el.parentNode.removeChild(n.el):n.destroy&&n.destroy(),delete e[t],n.children&&f(n.children)})}function d(){var e=t(g.apply(null,y))
u(o,e,b)}function u(t,n,o){Object.keys(o).forEach(function(e){if(!n[e]){var t=o[e]
t.destroy?t.destroy():t.el.parentNode.removeChild(t.el),delete o[e]}}),Object.keys(n).forEach(function(i){var l=o[i],a=n[i]
if(void 0!==a.text)return void(l?a.text!==l.text&&(l.text=a.text,l.el.nodeValue=a.text):(l=o[i]={text:a.text,el:document.createTextNode(a.text)},t.appendChild(l.el)))
if(a.el)return void(l?l.el!==a.el&&(t.removeChild(l.el),l.el=a.el):(l=o[i]={el:a.el},t.appendChild(l.el)))
if(a.component)return l||(l=o[i]=e(a.component,t,C),l.append()),void l.update.apply(null,a.data)
if(a.tagName)return l||(l=o[i]={tagName:a.tagName,el:document.createElement(a.tagName),children:{}},a.ref&&(l.ref=a.ref,h[l.ref]=l.el),t.appendChild(l.el)),l.props||(l.props={}),r(l.el,a.props,l.props),void(a.children&&u(l.el,a.children,l.children))
throw console.error(a),Error("This shouldn't happen")})}function s(){y=p.call(arguments),d()}function v(){if(!i)throw Error("Can't emit events from top-level component")
i.handleEvent.apply(null,arguments)}function m(e){var t=j[e]
if(!t){if(i)return i.handleEvent.apply(null,arguments)
throw Error("Missing event handler for "+e)}t.apply(null,p.call(arguments,1))}var h={},y=[],b={},E=n(v,d,h),g=E.render,j=E.on||{},x=E.cleanup||a,C={update:s,destroy:c,append:l,handleEvent:m},k=document.createComment(n.name)
return o.appendChild(k),C}function t(e){function t(e,r){var o,i,a
if("number"==typeof r&&(r+=""),"string"==typeof r)o="text"
else if(Array.isArray(r)){if(!r.length)return
if(i=r[0],"function"==typeof i)o="component"
else{if("string"!=typeof i)return void r.forEach(function(n){t(e,n)})
a=n(r),o="element"}}else{if(!(r instanceof HTMLElement))throw console.error(r),new TypeError("Invalid item")
o="el"}for(var c,f=0,d="element"===o?a.ref||a.name:"component"===o?r.key||r[0].name:o;e[c=d+"-"+f++];);var u
if("text"===o)return void(e[c]={text:r})
if("el"===o)return void(e[c]={el:r})
if("element"===o){var p={}
return u=e[c]={tagName:a.name},l(a.props)||(u.props=a.props),a.ref&&(u.ref=a.ref),a.body.forEach(function(e){t(p,e)}),void(l(p)||(u.children=p))}if("component"===o)return void(e[c]={component:r[0],data:r.slice(1)})
throw new TypeError("Invalid type")}var r={}
return t(r,e),r}function n(e){var t,n={}
if(e[1]&&e[1].constructor===Object){for(var r=Object.keys(e[1]),o=0,l=r.length;l>o;o++){var a=r[o]
n[a]=e[1][a]}t=e.slice(2)}else t=e.slice(1)
var p=e[0],s=p.match(u),v={name:s?s[0]:"div",props:n,body:t},m=p.match(c)
m&&(m=m.map(i).join(" "),n.class?n.class+=" "+m:n.class=m)
var h=p.match(f)
h&&(n.id=i(h[0]))
var y=p.match(d)
return y&&(v.ref=i(y[0])),v}function r(e,t,n){Object.keys(n).forEach(function(r){if(!t||!t[r]){if("on"===r.substr(0,2)){var o=r.substring(2)
e.removeEventListener(o,n[r])}else e.removeAttribute(r)
n[r]=null}}),t&&Object.keys(t).forEach(function(r){var i=t[r],l=n[r]
if("style"===r&&"object"==typeof i)"string"==typeof l&&e.removeAttribute("style"),l&&"object"==typeof l||(l=n.style={}),o(e.style,i,l)
else{if(l===i)return
if("on"===r.substr(0,2)){var a=r.substring(2)
l&&e.removeEventListener(a,l),e.addEventListener(a,i),n[r]=i}else e.setAttribute(r,"boolean"==typeof i?r:i),n[r]=i}})}function o(e,t,n){Object.keys(n).forEach(function(r){t&&t[r]||(n[r]=e[r]="")}),t&&Object.keys(t).forEach(function(r){var o=t[r],i=n[r]
i!==o&&(n[r]=e[r]=t[r])})}function i(e){return e.substring(1)}function l(e){return!Object.keys(e).length}function a(){}var c=/\.[^.#$]+/g,f=/#[^.#$]+/,d=/\$[^.#$]+/,u=/^[^.#$]+/,p=[].slice
return e})
